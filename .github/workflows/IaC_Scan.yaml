name: AccuKnox IaC Scan Workflow

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  tests:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@main
      
      - name: Run IaC scan
        uses: accuknox/iac-scan-action@v0.0.1
        with:
          directory: ./  
          quiet: 'true'                  
          output_file_path: ./results.json
          soft_fail: 'true'              
          token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzEwOTQ1NzIwLCJqdGkiOiIxODdjNTA2NmZlYjY0YmNiOWM4MTgzNDZhODRiMzg0NSIsImlzcyI6ImNzcG0uZGVtby5hY2N1a25veC5jb20ifQ.DkgKXqHg1iBsqqxUWEgvYwk8qcwWeRouEJzARu9gCEBfWcLWtnthhLk_enJDaK9R82vTRfgejnIIaIQp--u8qV0MWfCx6DCaZbvxemwcXuHMkgpmZUo7ZfR0aiWX3eB_ZIy7kqsNRkbcVyIBJcTYXAxgp7HNMTDIYXhJSQ6E61jxnmUXlh7_4-_CaLhvoCZRRl_Ij9h39nwLn5IzRcwTtAcyW7F_CqnAsm6vX8jWkuAGqM0kdw2P06AkD8N6Dxys1lwDBGHt2P9JzruQHiXUA23IRRHfNOiXSiW_WYvm2MyFMF26z3mnzDmkCxIjdEUseYv2Nzd3-a27fDt7ytfsig"
          endpoint: "cspm.demo.accuknox.com"
          tenant_id: "167"



     

      
        
        
  # framework: ansible, argo_workflows, arm, azure_pipelines, bicep, bitbucket_pipelines, cdk, circleci_pipelines, cloudformation, dockerfile, github_configuration, github_actions, gitlab_configuration, gitlab_ci, bitbucket_configuration, helm, json, yaml, kubernetes, kustomize, openapi, sca_package, sca_image, secrets, serverless, terraform, terraform_json, terraform_plan, sast, sast_python, sast_java, sast_javascript, 3d_policy.
