name: AccuKnox IaC Scan Workflow

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  tests:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@main
      
      - name: Run IaC scan
        uses: ./
        with:
          directory: ./  
          quiet: 'true'                  
          output_file_path: ./results
          framework: 'terraform'
          soft_fail: 'true'              
          token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzExMjAxNTA0LCJqdGkiOiI4OWIzNzNlMTA1ZmI0N2U0OWNiN2MyMjhkYzJkMGFjZiIsImlzcyI6ImNzcG0uZGV2LmFjY3Vrbm94LmNvbSJ9.ixbjFO6AIaN44Hi64fXdWnIuF187XLjrpIhDMfTwAPEjzSNMsLkPHMXvhT5cdlargwdbXSE-TeE39BplIIWcDP41FjtEYdf51Dhn8BBIG8suZmgJAQjV8qUpIVQqePSOgisDOEPT2UfuN4BPujg8VSbmv8dYuAMcenfefA_B1LRmtkg5bm0fdWiiHLlPgCRRM6HUNSsNtCPR3ZKs1A9K7_TnfdPQw-2d3Vk5HwPeeDszHUOa1md5aprauU9dM4LeDIZmZaHQ0VAIr-qytTXrmKXEm3n8UbsZFza4HaRH4auyxidGARekxy-rvCwqDdoYEyB_1zshZVLbfwv2VLQ94A"
          endpoint: "cspm.dev.accuknox.com"
          tenant_id: "1069"
          baseline: "baseline"



     

      
        
        
  # framework: ansible, argo_workflows, arm, azure_pipelines, bicep, bitbucket_pipelines, cdk, circleci_pipelines, cloudformation, dockerfile, github_configuration, github_actions, gitlab_configuration, gitlab_ci, bitbucket_configuration, helm, json, yaml, kubernetes, kustomize, openapi, sca_package, sca_image, secrets, serverless, terraform, terraform_json, terraform_plan, sast, sast_python, sast_java, sast_javascript, 3d_policy.
